<!--
  Animated Card Component
  
  A priority/roadmap card with large background icon, animated badge, and hover effects.
  
  Data Attributes:
    data-icon      - Material Symbols icon name (e.g., "database", "history_edu")
    data-title     - Card title text
    data-desc      - Card description text
    data-status    - Badge status: "queue" (animated primary) | "planned" (grayed) | "live" (green)
    data-href      - Optional link URL (wraps card in anchor)
  
  Usage:
    <div data-component="animated-card"
         data-icon="database"
         data-title="Commit to Database"
         data-desc="Phase 4 of the Extraction Workbench. Persist verified OCR text directly into the vault."
         data-status="queue">
    </div>
-->

<template id="animated-card-template">
    <div class="animated-card-wrapper">
        <div class="animated-card p-8 border border-primary/20 bg-archive-dark/60 shadow-2xl relative overflow-hidden group hover:border-primary/40 transition-all duration-300">
            <!-- Background Icon -->
            <div class="absolute -right-4 -top-4 opacity-5 group-hover:opacity-10 transition-all pointer-events-none">
                <span class="animated-card-bg-icon material-symbols-outlined text-[120px] text-primary"></span>
            </div>
            
            <!-- Header Row -->
            <div class="flex justify-between items-start mb-6 relative z-10">
                <span class="animated-card-icon material-symbols-outlined text-primary text-4xl font-light"></span>
                <span class="animated-card-badge px-2 py-1 text-[8px] font-bold uppercase tracking-widest border"></span>
            </div>
            
            <!-- Title -->
            <h4 class="animated-card-title text-lg font-bold text-archive-heading uppercase tracking-widest mb-4 relative z-10"></h4>
            
            <!-- Description -->
            <p class="animated-card-desc text-xs text-archive-secondary/70 leading-relaxed relative z-10"></p>
        </div>
    </div>
</template>

<script>
(function() {
    const STATUS_STYLES = {
        queue: {
            badge: 'bg-primary/10 text-primary border-primary/20 animate-pulse',
            label: 'In Queue',
            card: ''
        },
        planned: {
            badge: 'bg-archive-secondary/10 text-archive-secondary border-archive-secondary/20',
            label: 'Planned',
            card: 'opacity-50 grayscale'
        },
        live: {
            badge: 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20',
            label: 'Live',
            card: ''
        }
    };

    function initAnimatedCard(container) {
        const template = document.getElementById('animated-card-template');
        if (!template) return;

        const clone = template.content.cloneNode(true);
        const card = clone.querySelector('.animated-card');
        const wrapper = clone.querySelector('.animated-card-wrapper');

        const icon = container.dataset.icon || 'star';
        const title = container.dataset.title || 'Card Title';
        const desc = container.dataset.desc || 'Card description goes here.';
        const status = container.dataset.status || 'queue';
        const href = container.dataset.href;

        const styles = STATUS_STYLES[status] || STATUS_STYLES.queue;

        clone.querySelector('.animated-card-icon').textContent = icon;
        clone.querySelector('.animated-card-bg-icon').textContent = icon;
        clone.querySelector('.animated-card-title').textContent = title;
        clone.querySelector('.animated-card-desc').textContent = desc;

        const badge = clone.querySelector('.animated-card-badge');
        badge.textContent = styles.label;
        badge.className = `animated-card-badge px-2 py-1 text-[8px] font-bold uppercase tracking-widest border ${styles.badge}`;

        if (styles.card) {
            card.classList.add(...styles.card.split(' '));
        }

        if (href) {
            const link = document.createElement('a');
            link.href = href;
            link.className = 'block';
            link.appendChild(card);
            wrapper.innerHTML = '';
            wrapper.appendChild(link);
        }

        container.appendChild(clone);
    }

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('[data-component="animated-card"]').forEach(initAnimatedCard);
    });

    document.addEventListener('componentLoaded', (e) => {
        if (e.detail.name === 'animated-card') {
            initAnimatedCard(e.detail.element);
        }
    });
})();
</script>