<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Project Updates â€” Primary Sources</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&family=Roboto+Mono:wght@400;500;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/main.css">
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#B08B49",
                        "archive-bg": "#2E282A",
                        "archive-secondary": "#D4CFC7",
                        "archive-heading": "#F0EDE0",
                        "archive-dark": "#1A1718",
                    },
                    fontFamily: {
                        "display": ["Oswald", "sans-serif"],
                        "mono": ["Roboto Mono", "monospace"]
                    },
                    borderRadius: {
                        "DEFAULT": "0", "lg": "0", "xl": "0", "full": "9999px"
                    },
                },
            },
        }
    </script>
    <script src="assets/js/components.js" defer></script>
    <script src="assets/js/nav.js" defer></script>
</head>

<body class="bg-archive-bg text-archive-secondary font-mono transition-colors duration-300">

    <!-- MODULAR HEADER -->
    <header data-component="header"
        class="sticky top-0 z-50 w-full border-b border-archive-secondary/20 bg-archive-bg/95 backdrop-blur"></header>

    <!-- PAGE HEADER -->
    <section class="bg-archive-dark px-6 py-12 border-b border-archive-secondary/20">
        <div class="max-w-4xl mx-auto text-center">
            <span class="text-[10px] font-bold uppercase text-primary tracking-widest block mb-4">Project Blog</span>
            <h1 class="text-5xl font-bold leading-tight text-archive-heading uppercase font-display mb-4">
                Project Updates
            </h1>
            <p class="text-sm text-archive-secondary/80 max-w-2xl mx-auto">
                Updates, announcements, and insights about the Primary Sources digital archive project
            </p>
        </div>
    </section>

    <!-- CATEGORY FILTER -->
    <section class="px-6 py-6 border-b border-archive-secondary/20">
        <div class="max-w-6xl mx-auto">
            <div class="flex flex-wrap gap-2">
                <button onclick="filterByCategory('all')"
                    class="category-filter active px-4 py-2 text-xs uppercase tracking-widest border border-primary/40 text-primary bg-primary/10 hover:bg-primary/20 transition-colors">
                    All Posts
                </button>
                <button onclick="filterByCategory('featured')"
                    class="category-filter px-4 py-2 text-xs uppercase tracking-widest border border-archive-secondary/20 text-archive-secondary/70 hover:border-primary/40 hover:text-primary transition-colors">
                    Featured
                </button>
                <button onclick="filterByCategory('About')"
                    class="category-filter px-4 py-2 text-xs uppercase tracking-widest border border-archive-secondary/20 text-archive-secondary/70 hover:border-primary/40 hover:text-primary transition-colors">
                    About
                </button>
                <button onclick="filterByCategory('Development')"
                    class="category-filter px-4 py-2 text-xs uppercase tracking-widest border border-archive-secondary/20 text-archive-secondary/70 hover:border-primary/40 hover:text-primary transition-colors">
                    Development
                </button>
                <button onclick="filterByCategory('Research')"
                    class="category-filter px-4 py-2 text-xs uppercase tracking-widest border border-archive-secondary/20 text-archive-secondary/70 hover:border-primary/40 hover:text-primary transition-colors">
                    Research
                </button>
                <button onclick="filterByCategory('Updates')"
                    class="category-filter px-4 py-2 text-xs uppercase tracking-widest border border-archive-secondary/20 text-archive-secondary/70 hover:border-primary/40 hover:text-primary transition-colors">
                    Updates
                </button>
            </div>
        </div>
    </section>

    <!-- BLOG POSTS GRID -->
    <section class="px-6 py-12">
        <div class="max-w-6xl mx-auto">
            <div id="posts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Blog post cards injected here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="text-center py-20" style="display:none;">
                <span class="material-symbols-outlined text-6xl text-archive-secondary/20 mb-4 block">article</span>
                <p class="text-xs uppercase tracking-[0.3em] text-archive-secondary/40 mb-2">No Posts Found</p>
                <p class="text-sm text-archive-secondary/60">
                    No blog posts match the selected category.
                </p>
            </div>
        </div>
    </section>

    <!-- MODULAR FOOTER -->
    <div data-component="footer"></div>

    <!-- MODULAR BOTTOM NAV -->
    <nav data-component="bottom-nav" data-active="About"
        class="fixed bottom-0 z-50 w-full border-t border-archive-secondary/20 bg-archive-bg px-6 py-4"></nav>

    <div class="h-24"></div>

    <script>
        let allPosts = [];
        let currentCategory = 'all';

        // Load blog posts
        async function loadBlogPosts() {
            try {
                const response = await fetch('assets/data/blog.json');
                allPosts = await response.json();

                // Sort by date (newest first)
                allPosts.sort((a, b) => new Date(b.date) - new Date(a.date));

                // Render all posts
                renderPosts();
            } catch (err) {
                console.error('Failed to load blog posts:', err);
            }
        }

        function renderPosts() {
            const grid = document.getElementById('posts-grid');
            const emptyState = document.getElementById('empty-state');

            // Filter posts
            let filtered;
            if (currentCategory === 'all') {
                filtered = allPosts;
            } else if (currentCategory === 'featured') {
                filtered = allPosts.filter(p => p.featured === true);
            } else {
                filtered = allPosts.filter(p => p.category === currentCategory);
            }

            if (filtered.length === 0) {
                grid.innerHTML = '';
                emptyState.style.display = '';
                return;
            }

            emptyState.style.display = 'none';

            grid.innerHTML = filtered.map(post => `
                <a href="blog-post.html?slug=${post.slug}" class="block border border-archive-secondary/20 bg-[#252021]/60 hover:border-primary transition-colors overflow-hidden group">
                    ${post.hero_image ? `
                    <div class="aspect-video bg-archive-dark/50 overflow-hidden">
                        <img src="${post.hero_image}" alt="${post.title}" class="w-full h-full object-cover grayscale opacity-80 group-hover:grayscale-0 group-hover:opacity-100 transition-all duration-300" />
                    </div>
                    ` : ''}
                    <div class="p-6">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="text-[10px] px-2 py-1 bg-primary/20 text-primary uppercase tracking-widest">${post.category}</span>
                            <span class="text-[10px] text-archive-secondary/50 uppercase tracking-widest">${formatDate(post.date)}</span>
                        </div>
                        <h3 class="text-lg font-bold text-archive-heading uppercase font-display mb-2 group-hover:text-primary transition-colors">${post.title}</h3>
                        <p class="text-xs text-archive-secondary/70 leading-relaxed mb-4 line-clamp-3">${post.excerpt}</p>
                        ${post.tags && post.tags.length > 0 ? `
                        <div class="flex flex-wrap gap-1 mb-3">
                            ${post.tags.slice(0, 3).map(tag => `<span class="text-[9px] px-2 py-0.5 bg-archive-secondary/10 text-archive-secondary/60 uppercase tracking-wider">${tag}</span>`).join('')}
                        </div>
                        ` : ''}
                        <div class="flex items-center gap-2 text-xs text-primary uppercase tracking-widest">
                            <span>Read More</span>
                            <span class="material-symbols-outlined text-sm">arrow_forward</span>
                        </div>
                    </div>
                </a>
            `).join('');
        }

        function filterByCategory(category) {
            currentCategory = category;

            // Update active button
            document.querySelectorAll('.category-filter').forEach(btn => {
                btn.classList.remove('active', 'border-primary/40', 'text-primary', 'bg-primary/10');
                btn.classList.add('border-archive-secondary/20', 'text-archive-secondary/70');
            });

            event.target.classList.add('active', 'border-primary/40', 'text-primary', 'bg-primary/10');
            event.target.classList.remove('border-archive-secondary/20', 'text-archive-secondary/70');

            renderPosts();
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', loadBlogPosts);
    </script>

</body>

</html>